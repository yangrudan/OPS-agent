# OPS(Old People's) Agent

> 背景：toB 系列产品，旨在为老年人提供便捷、安全的智能生活体验。OPS Agent 作为其中的核心组件，致力于提升老年人的生活质量与安全性。

OPS Agent 是基于**MOFA-ai**框架设计与打造， 专为老年人设计的智能助手，遵循成为老年人的守护者的初心，为其提供覆盖**记忆**、 **安全**、 **天气**三大类型的核心服务。

## 核心功能

- 记忆：帮助老年人记住重要信息，如用药习惯、亲朋的联系方式、重要日期等。
- 安全：提供紧急求助功能，确保老年人在遇到危险时能迅速获得帮助。
- 天气：提供实时天气信息，帮助老年人合理安排出行和活动。

## 创新设计

- **自然语言交互**：老年人可以通过语音或文字与OPS Agent进行交流，无需复杂的操作。
- **硬件集成**：可以与各种智能硬件（如智能手表、智能手环设备等）集成，提供更便捷的服务。
- **向量数据库**：利用BAAI/bge模型和向量数据库存储和检索信息，确保信息的准确性和安全性。
- **中心调度节点**：ops-scheduler 作为中心调度节点，可以与智能设备、MCP服务进行无缝对接。

## 关键数据流说明（按场景拆解）

![数据流示意](./docs/dataflow.png)

### 场景 1：老人语音查天气（主动交互）
老人说 “小 O 小 O，今天天气怎么样？”→ A2（语音前端） 识别文本→传给 B（调度节点）；
B 向 C（记忆模块） 发送 “查李爷爷的住址” 请求→ C2（检索） 返回 “北京市朝阳区”→传给 B；
B 向 E（天气模块） 发送 “查朝阳区天气” 请求→ E1（API 调用） 返回 “晴，25℃，西北风 3 级”→传给 B；
B 向 G（LLM 模块） 发送 “用老人能听懂的话总结天气” 请求→ G2 生成 “李爷爷，今天是晴天，25 度，有点风，适合出门散步”→传给 B；
B 将 LLM 结果传给 A2（语音前端） → TTS 合成语音播放→老人听到反馈。
### 场景 2：手环检测血压异常（被动提醒 + 紧急响应）
F（智能手环） 检测到收缩压 185mmHg→ F2（异常上报） 实时传给 B（调度节点）；
B 优先触发安全流程：向 C（记忆模块） 查 “李爷爷紧急联系人”→返回 “儿子 138XXXX1234”→传给 B；
B 向 H（安全模块） 发送 “拨打儿子电话” 请求→ H1（呼叫） 接通后→反馈给 B；
同时，B 向 G（LLM 模块） 发送 “告知老人血压异常并安抚” 请求→ G2 生成 “李爷爷，您血压有点高，已联系儿子，别着急”→传给 B；
B 将 LLM 结果传给 A2（语音前端） → 播放安抚语音；同时，H2（风险记录） 将 “血压异常 + 呼叫儿子”→存入 C1（记忆模块）。
### 场景 3：天气降温触发用药提醒（主动提醒）
B（调度节点） 按定时任务（每 1 小时）向 E（天气模块） 发送 “更新天气” 请求→ E2（异常检测） 发现 “朝阳区明日降温 10℃”→传给 B；
B 向 C（记忆模块） 发送 “查李爷爷的用药时间” 请求→ C2 返回 “每天早上 8 点吃降压药”→传给 B；
B 向 G（LLM 模块） 发送 “整合降温 + 用药信息，生成提醒” 请求→ G2 生成 “李爷爷，明天降温 10 度，记得早上 8 点吃完降压药再出门，多穿件外套”→传给 B；
B 将提醒文本传给 A2（语音前端） → 次日早上 7:30 主动播放语音提醒；同时，C1 存储 “已提醒降温 + 用药”→避免重复提醒。

## 安装与使用

环境准备:

```bash
pip install mofa-ai- id: ops-scheduler
    build: pip install -e ../../node-hub/ops-scheduler
    path: ops-scheduler
    outputs:
      - scheduler_result
      - query  # 输出查询到记忆模块
      - weather_request  # 输出天气查询请求
    inputs:
      input_event: mock-voice/data  # 接收语音输入
      mem_result: ops-mem-agent/ops_mem_result  # 接收记忆模块结果
      weather_result: weather-agent/weather_data  # 接收天气模块结果

```

## 难点和突破

硬件接入

向量数据库

## 展望

1. 支持更多外设设备接入，如智能手表、智能手环等。
2. 支持更多场景，如健康管理、购物提醒等。
3. 提高语音识别和自然语言处理能力，实现更智能的交互。
